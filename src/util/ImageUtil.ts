import ImageSearch from 'google-images'

export class ImageUtil {
    public static async getBase64ImageFromUrl(src) {
        return new Promise<string>((resolve, reject) => {
            var img = new Image();
            img.crossOrigin = 'Anonymous';
            img.onload = () => {
                var canvas = <HTMLCanvasElement>document.createElement('CANVAS');
                var ctx = canvas.getContext('2d');
                var dataURL: string;
                canvas.height = img.naturalHeight;
                canvas.width = img.naturalWidth;
                ctx.drawImage(img, 0, 0);
                dataURL = canvas.toDataURL();
                resolve(dataURL);
            };
            img.onerror = reject;
            img.src = src;
            if (img.complete || img.complete === undefined) {
                img.src = this.defaultProductPhoto();
                img.src = src;
            }
        });
    }

    public static searchImage(productName, brandName) {
        console.log("Seach image for :", productName, brandName);
        return new Promise<string>((resolve, reject) => {
            var search = new ImageSearch("017492722026014867000:0eximjnxp4q", "AIzaSyASi27-j6s9Leapo0EBkh61ugVkiLUaLCY");
            search.search(productName)
                .then(images => {
                    console.log("Images, ", images);
                    if (images.length > 0) {
                        console.log("Found Image - ", images[0].url.toString());
                        resolve(images[0].url.toString());
                    }
                })
                .catch(err => {
                    console.info("Image search error", err);
                });
        });

    }

    public static defaultProductPhoto() {
        return 'data:image/png;base64,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';
    }
}